{"ast":null,"code":"const shoppingCartInitialState = {\n  cartItems: [],\n  orderTotal: 0,\n  cartItemsTotal: 0\n};\n\nconst updateCartItems = (cartItems, item, index) => {\n  if (index === -1) {\n    return [...cartItems, item];\n  }\n\n  return [...cartItems.slice(0, index), item.count > 0 && item, ...cartItems.slice(++index)];\n};\n\nconst updateCartItem = (book, item = {}) => {\n  const {\n    id = book.id,\n    name = book.name,\n    count = 0,\n    total = 0\n  } = item;\n  return {\n    id,\n    name,\n    count: count + 1,\n    total: book.price + total\n  };\n};\n\nconst updateOrderTotal = cartItems => {\n  return cartItems.reduce((finish, element) => finish + element.total, 0);\n};\n\nconst updateCartItemsCountTotal = cartItems => {\n  return cartItems.reduce((finish, element) => finish + element.count, 0);\n};\n\nexport const shoppingCartReducer = (state = shoppingCartInitialState, action) => {\n  switch (action.type) {\n    //bookList\n    //shoppingCart\n    case 'BOOK_ADDED_TO_CART':\n      const ID = action.payload; // clicked id\n\n      const currentBook = state.bookList.books.find(book => book.id === ID); // book from list\n\n      const isBookInCartIndex = state.shoppingCart.cartItems.findIndex(book => book.id === ID); // >0 || -1\n\n      const bookInCart = state.shoppingCart.cartItems[isBookInCartIndex]; // index || undefined\n\n      const data = updateCartItem(currentBook, bookInCart);\n      const newList = updateCartItems(state.shoppingCartcartItems, data, isBookInCartIndex);\n      return { ...state,\n        cartItems: newList,\n        orderTotal: updateOrderTotal(newList),\n        cartItemsTotal: updateCartItemsCountTotal(newList)\n      };\n\n    case 'BOOKS_DELETED_FROM_CART':\n      const booksID = action.payload; // clicked id\n\n      const newCartList = state.cartItems.filter(({\n        id\n      }) => id !== booksID);\n      return { ...state,\n        cartItems: newCartList,\n        orderTotal: updateOrderTotal(newCartList),\n        cartItemsTotal: updateCartItemsCountTotal(newCartList)\n      };\n\n    case 'BOOK_DELETED_FROM_CART':\n      const bookID = action.payload; // clicked id\n\n      let newCarts = [...state.cartItems];\n      const deletedBooksGroup = newCarts.find(({\n        id\n      }) => id === bookID);\n      const getCount = deletedBooksGroup.count - 1;\n      let getTotal;\n\n      if (getCount === 0) {\n        newCarts = newCarts.filter(({\n          id\n        }) => id !== bookID);\n      } else {\n        getTotal = deletedBooksGroup.total / deletedBooksGroup.count;\n        deletedBooksGroup.count = getCount;\n        deletedBooksGroup.total -= getTotal;\n      }\n\n      return { ...state,\n        cartItems: newCarts,\n        orderTotal: updateOrderTotal(newCarts),\n        cartItemsTotal: updateCartItemsCountTotal(newCarts)\n      };\n\n    default:\n      return state;\n  }\n};","map":{"version":3,"sources":["/home/user/Рабочий стол/redux-sandbox/src/reducers/shoppingCartReducer.js"],"names":["shoppingCartInitialState","cartItems","orderTotal","cartItemsTotal","updateCartItems","item","index","slice","count","updateCartItem","book","id","name","total","price","updateOrderTotal","reduce","finish","element","updateCartItemsCountTotal","shoppingCartReducer","state","action","type","ID","payload","currentBook","bookList","books","find","isBookInCartIndex","shoppingCart","findIndex","bookInCart","data","newList","shoppingCartcartItems","booksID","newCartList","filter","bookID","newCarts","deletedBooksGroup","getCount","getTotal"],"mappings":"AAAA,MAAMA,wBAAwB,GAAG;AAC7BC,EAAAA,SAAS,EAAE,EADkB;AAE7BC,EAAAA,UAAU,EAAE,CAFiB;AAG7BC,EAAAA,cAAc,EAAE;AAHa,CAAjC;;AAMA,MAAMC,eAAe,GAAG,CAACH,SAAD,EAAYI,IAAZ,EAAkBC,KAAlB,KAA4B;AAChD,MAAIA,KAAK,KAAK,CAAC,CAAf,EAAkB;AACd,WAAO,CACH,GAAGL,SADA,EAEHI,IAFG,CAAP;AAIH;;AACD,SAAO,CACH,GAAGJ,SAAS,CAACM,KAAV,CAAgB,CAAhB,EAAmBD,KAAnB,CADA,EAEHD,IAAI,CAACG,KAAL,GAAa,CAAb,IAAkBH,IAFf,EAGH,GAAGJ,SAAS,CAACM,KAAV,CAAgB,EAAED,KAAlB,CAHA,CAAP;AAKH,CAZD;;AAcA,MAAMG,cAAc,GAAG,CAACC,IAAD,EAAOL,IAAI,GAAG,EAAd,KAAqB;AACxC,QAAM;AAACM,IAAAA,EAAE,GAAGD,IAAI,CAACC,EAAX;AAAeC,IAAAA,IAAI,GAAGF,IAAI,CAACE,IAA3B;AAAiCJ,IAAAA,KAAK,GAAG,CAAzC;AAA4CK,IAAAA,KAAK,GAAG;AAApD,MAAyDR,IAA/D;AACA,SAAO;AACHM,IAAAA,EADG;AAEHC,IAAAA,IAFG;AAGHJ,IAAAA,KAAK,EAAEA,KAAK,GAAG,CAHZ;AAIHK,IAAAA,KAAK,EAAEH,IAAI,CAACI,KAAL,GAAaD;AAJjB,GAAP;AAMH,CARD;;AAUA,MAAME,gBAAgB,GAAId,SAAD,IAAe;AACpC,SAAOA,SAAS,CAACe,MAAV,CAAiB,CAACC,MAAD,EAASC,OAAT,KAAqBD,MAAM,GAAGC,OAAO,CAACL,KAAvD,EAA8D,CAA9D,CAAP;AACH,CAFD;;AAIA,MAAMM,yBAAyB,GAAIlB,SAAD,IAAe;AAC7C,SAAOA,SAAS,CAACe,MAAV,CAAiB,CAACC,MAAD,EAASC,OAAT,KAAqBD,MAAM,GAAGC,OAAO,CAACV,KAAvD,EAA8D,CAA9D,CAAP;AACH,CAFD;;AAIA,OAAO,MAAMY,mBAAmB,GAAG,CAACC,KAAK,GAAGrB,wBAAT,EAAmCsB,MAAnC,KAA8C;AAE7E,UAAQA,MAAM,CAACC,IAAf;AACI;AACR;AACQ,SAAK,oBAAL;AACI,YAAMC,EAAE,GAAGF,MAAM,CAACG,OAAlB,CADJ,CAC+B;;AAC3B,YAAMC,WAAW,GAAGL,KAAK,CAACM,QAAN,CAAeC,KAAf,CAAqBC,IAArB,CAA0BnB,IAAI,IAAIA,IAAI,CAACC,EAAL,KAAYa,EAA9C,CAApB,CAFJ,CAE0E;;AACtE,YAAMM,iBAAiB,GAAGT,KAAK,CAACU,YAAN,CAAmB9B,SAAnB,CAA6B+B,SAA7B,CAAuCtB,IAAI,IAAIA,IAAI,CAACC,EAAL,KAAYa,EAA3D,CAA1B,CAHJ,CAG6F;;AACzF,YAAMS,UAAU,GAAGZ,KAAK,CAACU,YAAN,CAAmB9B,SAAnB,CAA6B6B,iBAA7B,CAAnB,CAJJ,CAIuE;;AACnE,YAAMI,IAAI,GAAGzB,cAAc,CAACiB,WAAD,EAAcO,UAAd,CAA3B;AACA,YAAME,OAAO,GAAG/B,eAAe,CAACiB,KAAK,CAACe,qBAAP,EAA8BF,IAA9B,EAAoCJ,iBAApC,CAA/B;AACA,aAAO,EACH,GAAGT,KADA;AAEHpB,QAAAA,SAAS,EAAEkC,OAFR;AAGHjC,QAAAA,UAAU,EAAEa,gBAAgB,CAACoB,OAAD,CAHzB;AAIHhC,QAAAA,cAAc,EAAEgB,yBAAyB,CAACgB,OAAD;AAJtC,OAAP;;AAOJ,SAAK,yBAAL;AACI,YAAME,OAAO,GAAGf,MAAM,CAACG,OAAvB,CADJ,CACoC;;AAChC,YAAMa,WAAW,GAAGjB,KAAK,CAACpB,SAAN,CAAgBsC,MAAhB,CAAuB,CAAC;AAAC5B,QAAAA;AAAD,OAAD,KAAUA,EAAE,KAAK0B,OAAxC,CAApB;AACA,aAAO,EACH,GAAGhB,KADA;AAEHpB,QAAAA,SAAS,EAAEqC,WAFR;AAGHpC,QAAAA,UAAU,EAAEa,gBAAgB,CAACuB,WAAD,CAHzB;AAIHnC,QAAAA,cAAc,EAAEgB,yBAAyB,CAACmB,WAAD;AAJtC,OAAP;;AAOJ,SAAK,wBAAL;AACI,YAAME,MAAM,GAAGlB,MAAM,CAACG,OAAtB,CADJ,CACmC;;AAC/B,UAAIgB,QAAQ,GAAG,CAAC,GAAGpB,KAAK,CAACpB,SAAV,CAAf;AACA,YAAMyC,iBAAiB,GAAGD,QAAQ,CAACZ,IAAT,CAAc,CAAC;AAAClB,QAAAA;AAAD,OAAD,KAAUA,EAAE,KAAK6B,MAA/B,CAA1B;AACA,YAAMG,QAAQ,GAAGD,iBAAiB,CAAClC,KAAlB,GAA0B,CAA3C;AACA,UAAIoC,QAAJ;;AACA,UAAID,QAAQ,KAAK,CAAjB,EAAoB;AAChBF,QAAAA,QAAQ,GAAGA,QAAQ,CAACF,MAAT,CAAgB,CAAC;AAAC5B,UAAAA;AAAD,SAAD,KAAUA,EAAE,KAAK6B,MAAjC,CAAX;AACH,OAFD,MAEO;AACHI,QAAAA,QAAQ,GAAGF,iBAAiB,CAAC7B,KAAlB,GAA0B6B,iBAAiB,CAAClC,KAAvD;AACAkC,QAAAA,iBAAiB,CAAClC,KAAlB,GAA0BmC,QAA1B;AACAD,QAAAA,iBAAiB,CAAC7B,KAAlB,IAA2B+B,QAA3B;AACH;;AACD,aAAO,EACH,GAAGvB,KADA;AAEHpB,QAAAA,SAAS,EAAEwC,QAFR;AAGHvC,QAAAA,UAAU,EAAEa,gBAAgB,CAAC0B,QAAD,CAHzB;AAIHtC,QAAAA,cAAc,EAAEgB,yBAAyB,CAACsB,QAAD;AAJtC,OAAP;;AAOJ;AACI,aAAOpB,KAAP;AAhDR;AAmDH,CArDM","sourcesContent":["const shoppingCartInitialState = {\n    cartItems: [],\n    orderTotal: 0,\n    cartItemsTotal: 0\n}\n\nconst updateCartItems = (cartItems, item, index) => {\n    if (index === -1) {\n        return [\n            ...cartItems,\n            item\n        ]\n    }\n    return [\n        ...cartItems.slice(0, index),\n        item.count > 0 && item,\n        ...cartItems.slice(++index)\n    ]\n}\n\nconst updateCartItem = (book, item = {}) => {\n    const {id = book.id, name = book.name, count = 0, total = 0} = item\n    return {\n        id,\n        name,\n        count: count + 1,\n        total: book.price + total,\n    }\n}\n\nconst updateOrderTotal = (cartItems) => {\n    return cartItems.reduce((finish, element) => finish + element.total, 0)\n}\n\nconst updateCartItemsCountTotal = (cartItems) => {\n    return cartItems.reduce((finish, element) => finish + element.count, 0)\n}\n\nexport const shoppingCartReducer = (state = shoppingCartInitialState, action) => {\n\n    switch (action.type) {\n        //bookList\n//shoppingCart\n        case 'BOOK_ADDED_TO_CART' :\n            const ID = action.payload; // clicked id\n            const currentBook = state.bookList.books.find(book => book.id === ID) // book from list\n            const isBookInCartIndex = state.shoppingCart.cartItems.findIndex(book => book.id === ID) // >0 || -1\n            const bookInCart = state.shoppingCart.cartItems[isBookInCartIndex] // index || undefined\n            const data = updateCartItem(currentBook, bookInCart)\n            const newList = updateCartItems(state.shoppingCartcartItems, data, isBookInCartIndex)\n            return {\n                ...state,\n                cartItems: newList,\n                orderTotal: updateOrderTotal(newList),\n                cartItemsTotal: updateCartItemsCountTotal(newList)\n            }\n\n        case 'BOOKS_DELETED_FROM_CART' :\n            const booksID = action.payload; // clicked id\n            const newCartList = state.cartItems.filter(({id}) => id !== booksID);\n            return {\n                ...state,\n                cartItems: newCartList,\n                orderTotal: updateOrderTotal(newCartList),\n                cartItemsTotal: updateCartItemsCountTotal(newCartList)\n            }\n\n        case 'BOOK_DELETED_FROM_CART' :\n            const bookID = action.payload; // clicked id\n            let newCarts = [...state.cartItems]\n            const deletedBooksGroup = newCarts.find(({id}) => id === bookID)\n            const getCount = deletedBooksGroup.count - 1;\n            let getTotal;\n            if (getCount === 0) {\n                newCarts = newCarts.filter(({id}) => id !== bookID)\n            } else {\n                getTotal = deletedBooksGroup.total / deletedBooksGroup.count\n                deletedBooksGroup.count = getCount\n                deletedBooksGroup.total -= getTotal\n            }\n            return {\n                ...state,\n                cartItems: newCarts,\n                orderTotal: updateOrderTotal(newCarts),\n                cartItemsTotal: updateCartItemsCountTotal(newCarts)\n            }\n\n        default:\n            return state\n\n    }\n}"]},"metadata":{},"sourceType":"module"}