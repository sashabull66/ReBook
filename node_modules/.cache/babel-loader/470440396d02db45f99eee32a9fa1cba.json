{"ast":null,"code":"const initialState = {\n  books: [],\n  loading: true,\n  error: null,\n  cartItems: [],\n  orderTotal: 0\n};\n\nconst updateCartItems = (cartItems, item, index) => {\n  if (index === -1) {\n    return [...cartItems, item];\n  }\n\n  return [...cartItems.slice(0, index), item, ...cartItems.slice(++index)];\n};\n\nconst updateCartItem = (book, item) => {\n  let data;\n\n  if (item) {\n    data = { ...item,\n      count: item.count + 1,\n      total: item.total + item.total / item.count\n    };\n  } else {\n    data = {\n      id: book.id,\n      name: book.name,\n      count: 1,\n      total: book.price\n    };\n  }\n};\n\nexport const reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case 'FETCH_BOOKS_SUCCESS':\n      return { ...state,\n        books: action.payload,\n        loading: false,\n        error: null\n      };\n\n    case 'FETCH_BOOKS_REQUEST':\n      return { ...state,\n        books: [],\n        loading: true,\n        error: null\n      };\n\n    case 'FETCH_BOOKS_FAILURE':\n      return { ...state,\n        books: [],\n        loading: false,\n        error: action.payload\n      };\n\n    case 'BOOK_ADDED_TO_CART':\n      const ID = action.payload; // clicked id\n\n      const currentBook = state.books.find(book => book.id === ID); // book from list\n\n      const isBookInCartIndex = state.cartItems.findIndex(book => book.id === ID); // >0 || -1\n\n      const bookInCart = state.cartItems[isBookInCartIndex]; // index || undefined\n\n      return { ...state,\n        cartItems: updateCartItems(state.cartItems, data, isBookInCartIndex),\n        orderTotal: state.orderTotal + currentBook.price\n      };\n\n    default:\n      return state;\n  }\n};","map":{"version":3,"sources":["/home/user/Рабочий стол/redux-sandbox/src/reducers/index.js"],"names":["initialState","books","loading","error","cartItems","orderTotal","updateCartItems","item","index","slice","updateCartItem","book","data","count","total","id","name","price","reducer","state","action","type","payload","ID","currentBook","find","isBookInCartIndex","findIndex","bookInCart"],"mappings":"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","sourcesContent":["const initialState = {\n    books: [],\n    loading: true,\n    error: null,\n    cartItems: [],\n    orderTotal: 0\n}\n\nconst updateCartItems = (cartItems, item, index) => {\n    if (index === -1) {\n        return [\n            ...cartItems,\n            item\n        ]\n    }\n    return [\n        ...cartItems.slice(0, index),\n        item,\n        ...cartItems.slice(++index)\n    ]\n}\n\nconst updateCartItem = (book, item) => {\n    let data;\n    if (item) {\n        data = {\n            ...item,\n            count: item.count + 1,\n            total: item.total + (item.total / item.count),\n        }\n    } else {\n        data = {\n            id: book.id,\n            name: book.name,\n            count: 1,\n            total: book.price,\n        }\n    }\n}\n\nexport const reducer = (state = initialState, action) => {\n\n    switch (action.type) {\n\n        case 'FETCH_BOOKS_SUCCESS' :\n            return {\n                ...state,\n                books: action.payload,\n                loading: false,\n                error: null\n            }\n\n        case 'FETCH_BOOKS_REQUEST' :\n            return {\n                ...state,\n                books: [],\n                loading: true,\n                error: null\n            }\n\n        case 'FETCH_BOOKS_FAILURE' :\n            return {\n                ...state,\n                books: [],\n                loading: false,\n                error: action.payload\n            }\n\n        case 'BOOK_ADDED_TO_CART' :\n            const ID = action.payload; // clicked id\n            const currentBook = state.books.find(book => book.id === ID) // book from list\n            const isBookInCartIndex = state.cartItems.findIndex(book => book.id === ID) // >0 || -1\n            const bookInCart = state.cartItems[isBookInCartIndex] // index || undefined\n\n\n                return {\n                    ...state,\n                    cartItems: updateCartItems(state.cartItems, data, isBookInCartIndex),\n                    orderTotal: state.orderTotal + currentBook.price\n                }\n\n\n\n        default:\n            return state\n    }\n}"]},"metadata":{},"sourceType":"module"}